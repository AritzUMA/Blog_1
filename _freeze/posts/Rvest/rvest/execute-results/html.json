{
  "hash": "421dc99575e5227fd35753d2971947ff",
  "result": {
    "markdown": "---\ntitle: 'Rvest package fof Web Scraping: Newspaper example'\ndate: '2022-06-01'\ncategories: ['123', 'Second Tag']\ndescription: 'Webscraping'\nexecute: \n  message: false\n  warning: false\neditor_options: \n  chunk_output_type: console\n---\n\n\n![](rvest.png)\n\n# Ethic Webscraping\n\nThe first thing we have to know is that the web sraping is a automatization of the webpages publiclky avaible information. There is a several legislations about this tecnique, like the [GDPR](https://gdpr.eu/) in Europe, in wich is delimeted for the Personal data or Personally Identifiablke Information (PII). So, we have to avoid the problematic question of the scraping personal data of european citizens and if we have to do it, follow the legals questions regarded in the GDPR.\n\nApart from the legal cuestion, it is impiortant to know that webscraping is technique that relantizes the servers of the companies if we do it very agressivly. Is for this that we have to priorice the APIs (Aplication Programminf Interface) avaiable for the webpages if there are. This aplications are prepared to dowload the information and don't disturb the normal function of the servers of the webpages.\\\n\\\nKnowing this information, we can start with the first of the 4 packages to webscraping information in R: Rvest.\n\n## First steps\n\nThe rvest package have his own [website](https://rvest.tidyverse.org/) and is avaiable the full documentation in the [CRAN](https://cran.r-project.org/web/packages/rvest/rvest.pdf) repository. Is a very easy package to use and to deal with, in wich the principal focus is in the html structure and there csss, tags or Xpaths between others. Lets try to do this easy tutorial with a [naiz.eus](https://www.naiz.eus/) webpage and the news that are avaiable.\n\n## 1 - Install and load the library\n\nLike always, we need install the pacakge.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"rvest\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nThe following package(s) will be installed:\n- rvest [1.0.3]\nThese packages will be installed into \"~/MEGAsync/Proyectos/Blog_1/renv/library/R-4.1/x86_64-pc-linux-gnu\".\n\n# Installing packages --------------------------------------------------------\n- Installing rvest ...                          OK [linked from cache]\nSuccessfully installed 1 package in 8 milliseconds.\n```\n:::\n:::\n\n\nOnce the package is installed, we need \"call\" the package to use their functions.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rvest)\nlibrary(tidyverse)\n```\n:::\n\n\n## 2 - Read the page\n\nFirst of all we need to read the page in pur local machine, is for this that we need to use read_html() function to save the html structure in the variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nNews_paper <- read_html(\"https://www.naiz.eus/\")\n\nprint(News_paper)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n{html_document}\n<html lang=\"eu\" xml:lang=\"eu\">\n[1] <head>\\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8 ...\n[2] <body>\\n<div data-controller=\"cookies\" data-cookies-content-value=\"&lt;h2 ...\n```\n:::\n:::\n\n\n## 3 - Find the CSS\n\nLike we see, we have the newspaper html structure in our variable. Once this is donne, we need to extract the css responsabile for the titles of the newspaper. For this task we can do it manually, clicking in the right button on the mouse and selecting the \"inspect\" option we can find manually the common css for all the titles of the articles.\n\n![](CSS_manually.png) We can see that the common class or css por the articles is article, but if we move the mouse on the articles, we will see that the css us for all the article, no only the title. This way we need to split the article class to see how it the article divided in different classes to see what css is the correct one. We will see something like this image, in wich each article is separated in different css\n\n![](CSS_manually_title.png) Like we see, the css \"article\\_\\_title\" is our appropiate css we need to use to extract the title of the article.\n\nOther way to do this more easy, is to install add ons we can use for this task (I use [SelectorHub](#0) for Firefox and [Selectorgadget](#0) for chrome navigator). This way we can select easier the css we want to dowload. In our case is\n\n## 4 - Extract the css information\n\nFirst of all we have to ensure that our css is apropuiate. For this lets try first to extract the first title. For this, first we have to stablish the csss like a node in wich we want extract and then extract the text of the node we determinate.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nNews_paper_title <- News_paper %>% html_node(\".article__title\") %>% html_text()\nprint(News_paper_title)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"\\n      Migrazio Legearen hainbat neurri atzera bota ditu Kontseilu Konstituzionalak\\n      \\n    \"\n```\n:::\n:::\n\n\nWe can see the the first title of the webpage, lets see if how we can get the second one.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nNews_paper_title_second <- News_paper %>% html_node(\".article__title:nth-child(2)\") %>% html_text()\nprint(News_paper_title)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"\\n      Migrazio Legearen hainbat neurri atzera bota ditu Kontseilu Konstituzionalak\\n      \\n    \"\n```\n:::\n:::\n\n\nWe can access to the \"childs\" of the css this way.\n\nNow, we want all the titles toguether in one variable. Lets try to find trought the SelectorGadget in google chrome. For this goal we need to find apropiate css selecting with the add on. Once we see all the titles selected, we can try if all is correct with the selected css.\n\n![](CSS_selector.png)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nNews_paper_titles <- News_paper %>% html_nodes(\".article__title a\") %>% html_text()\nNews_paper_titles\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Migrazio Legearen hainbat neurri atzera bota ditu Kontseilu Konstituzionalak\"                                         \n [2] \"Nafarroa reitera que a la empresa de Artaxoa no se enviaban lodos desde Zubieta, sino líquidos\"                       \n [3] \"TJUE: el plazo para reclamar los gastos hipotecarios empieza cuando el cliente conoce el fraude\"                      \n [4] \"Williams anaien kondairaren azken pasartea, Hollywoodeko gidoi baterako aproposa\"                                     \n [5] \"‘Hijas del fuego’, una miniserie sobre la caza de brujas en Zugarramurdi\"                                             \n [6] \"\\n        La Diputación de Bizkaia contradice a Urkullu: los dos años son para ver cómo será el museo\\n        \\n\"    \n [7] \"\\n        EH Bildu alcanza con PSE y PNV un pacto presupuestario en Gasteiz por 6 millones de euros\\n        \\n\"      \n [8] \"\\n        Joseba Diez hautagai gisa babestu dute EAJren afiliatuek, zuzendaritzak proposatu ez bazuen ere\\n        \\n\"\n [9] \"\\n        Solo el PP no quiere dar pasos hacia la declaración de Donostia como ciudad tensionada\\n        \\n\"         \n[10] \"Proyecto BCC en Gros-Ulía, ¿capricho o cabezonería de los cocineros estrellas?\"                                       \n[11] \"\\n        PNV y PSE impiden debatir una moción de urgencia sobre la tala de árboles en Gros\\n        \\n\"              \n[12] \"\\n        Más de 96.000 personas están en riesgo de pobreza en Nafarroa, casi una de cada seis\\n        \\n\"           \n[13] \"\\n        Denuncian un «trato indigno» hacia personas sin hogar en las Urgencias Sociales de Bilbo\\n        \\n\"       \n[14] \"\\n        Lanik gabe dauden gazteen %72k 2024an lana aurkituko duela uste du\\n        \\n\"                             \n[15] \"\\n        Fallece una persona en un choque frontal cerca del alto de Gaintxurizketa\\n        \\n\"                      \n[16] \"\\n        Aniztasuna\\n        \\n\"                                                                                     \n[17] \"\\n        La fiscal mantiene la petición de casi quince años para los acusados por la paliza de Zornotza\\n        \\n\" \n[18] \"\\n        «Instituzioen logika XX. mendekoa da: bidea egin baino gehiago, bidea urratu egin behar da»\\n        \\n\"    \n[19] \"\\n        Astigarraga eta Hernanik bisitariei zuzendutako mezua: «Ez da sagardoa, zu zara. Hartu ardura!»\\n        \\n\"\n[20] \"\\n        Gorrotxategi se postula a las primarias en Podemos sin acuerdo aún con el resto de fuerzas\\n        \\n\"     \n[21] \"\\n        Esparza dice que la adjudicación de Belate «apesta» y el Gobierno defiende su legalidad\\n        \\n\"        \n[22] \"\\n        La FNSEA reclama una moratoria en la prohibición de usar pesticidas\\n        \\n\"                            \n[23] \"\\n        Los bomberos de Donostia acuden al Pleno para denunciar que no han mejorado sus condiciones\\n        \\n\"    \n[24] \"\\n        LAB denuncia la escasez de uniformes, sábanas y mantas en el hospital de Basurto\\n        \\n\"               \n[25] \"\\n        Sindicatos se concentran en Gasteiz para pedir que se cumplan las medidas de salud laboral\\n        \\n\"     \n[26] \"\\n        Gazako biztanleriaren erdia baino gehiago Rafahn pilatuta dago, NBEren arabera\\n        \\n\"                 \n[27] \"Gaza: encendamos la luz de la solidaridad\"                                                                            \n[28] \"\\n        Migrazio legearen alde bozkatu zuten hautetsien argazkiekin afitxak jarri ditu Bizi!k\\n        \\n\"          \n[29] \"\\n        El juez no descarta el «ánimo homicida» en la causa de Tsunami para evitar la Ley de Amnistía\\n        \\n\"  \n[30] \"\\n        Las milicias iraquíes proiraníes instan a extender sus ataques al Mediterráneo\\n        \\n\"                 \n[31] \"\\n        El BCE mantiene los tipos de interés en el 4,5% por tercera vez consecutiva\\n        \\n\"                    \n[32] \"\\n        Las lentejas, el tocino y la velocidad\\n        \\n\"                                                         \n[33] \"\\n        Un niño sordo escucha por primera vez tras un innovador tratamiento génico en EEUU\\n        \\n\"             \n[34] \"\\n        Elurra bezain zuria: ezohiko pinguino bat Antartikan\\n        \\n\"                                           \n[35] \"\\n        Los hermanos Williams llegan a tiempo y desatan la locura en San Mamés (4-2)\\n        \\n\"                   \n[36] \"\\n        La AN propone juzgar a Luis Rubiales por el beso «no consentido» a Jenni Hermoso\\n        \\n\"               \n[37] \"\\n        La Real confirma la cesión del lateral Javi Galán, procedente del Atlético\\n        \\n\"                     \n[38] \"\\n        Nicolás Alustiza, ilusionado tras sus primeros días como ciclista profesional con el Euskaltel\\n        \\n\" \n[39] \"\\n        ‘Euskararen baloia’ ekimenaren edizio berriari hasiera eman dio Eibarrek\\n        \\n\"                       \n[40] \"\\n        Kilian Jornetek eta Zach Millerrek eliteko korrikalariei eskatu diete UTMB-i boikota egitea\\n        \\n\"    \n[41] \"\\n        Jordan Theodore, tardío regalo navideño que viene para que Baskonia sea mejor equipo\\n        \\n\"           \n[42] \"\\n        Bilbao Basket ya sabe lo que es perder en Europa y lía un tanto su pase a cuartos (82-80)\\n        \\n\"      \n[43] \"\\n        «Lokalean bertsioekin jolasean hasi eta disko bat osatzeko erronka bete dugu»\\n        \\n\"                  \n[44] \"dFeria cumple 30 años con Italia como país invitado, bajo el lema ‘Utopía’\"                                           \n[45] \"\\n        Musika Bulegoa: «2023a urte ona izan da zuzeneko musikarentzat»\\n        \\n\"                                \n[46] \"\\n        ‘Ama’ diskoa aurkeztu du Tenpora taldeak, sei abesti berriz osatutako lana\\n        \\n\"                     \n[47] \"Isabel Azkaratek artearekin eta sortzaileekin duen harremanaren lekuko da San Telmo\"                                  \n[48] \"Atzar Hadi! ikuskizuna Oialume Biltokian\"                                                                             \n[49] \"Jon Gurrutxaga Marruma Kulturaletan\"                                                                                  \n[50] \"Letagin eta Nevadah indarrak batuz Ondarrun\"                                                                          \n[51] \"Lausoka Txantreako Akelarre elkartean\"                                                                                \n[52] \"Musikagaz Fest! jaialdiaren bigarren edizioa egingo dute Zornotzan\"                                                   \n[53] \"\\n        «Erresilientzia ez da presioa jasatea soilik, baizik eta esperientzietatik indartuta ateratzea»\\n        \\n\"\n[54] \"\\n        Getariatik mundura: Cristobal Balenciaga\\n        \\n\"                                                       \n[55] \"\\n        «Beldur naiz, akordio zabalen alde, abertzaletasuna alboratzen ari ez ote garen»\\n        \\n\"               \n[56] \"\\n        Kaiman uharteak; finantzak, hondartzak eta askoz gehiago\\n        \\n\"                                       \n[57] \"\\n        Zetaren Bideko hirietan zehar\\n        \\n\"                                                                  \n[58] \"\\n        Urederra, harribitxi urdin turkesa, Urbasa mendilerroan\\n        \\n\"                                        \n[59] \"\\n        «Lokalean bertsioekin jolasean hasi eta disko bat osatzeko erronka bete dugu»\\n        \\n\"                  \n```\n:::\n:::\n\n\nNow we can use one of multiples packages avaible to clean the text, but to do it simple, we can do it ease witn the function gsub()\n\n\n::: {.cell}\n\n```{.r .cell-code}\nNews_paper_titles <- gsub(\"\\n        \\n|\\n        \",\"\",News_paper_titles)\nNews_paper_titles\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Migrazio Legearen hainbat neurri atzera bota ditu Kontseilu Konstituzionalak\"                   \n [2] \"Nafarroa reitera que a la empresa de Artaxoa no se enviaban lodos desde Zubieta, sino líquidos\" \n [3] \"TJUE: el plazo para reclamar los gastos hipotecarios empieza cuando el cliente conoce el fraude\"\n [4] \"Williams anaien kondairaren azken pasartea, Hollywoodeko gidoi baterako aproposa\"               \n [5] \"‘Hijas del fuego’, una miniserie sobre la caza de brujas en Zugarramurdi\"                       \n [6] \"La Diputación de Bizkaia contradice a Urkullu: los dos años son para ver cómo será el museo\"    \n [7] \"EH Bildu alcanza con PSE y PNV un pacto presupuestario en Gasteiz por 6 millones de euros\"      \n [8] \"Joseba Diez hautagai gisa babestu dute EAJren afiliatuek, zuzendaritzak proposatu ez bazuen ere\"\n [9] \"Solo el PP no quiere dar pasos hacia la declaración de Donostia como ciudad tensionada\"         \n[10] \"Proyecto BCC en Gros-Ulía, ¿capricho o cabezonería de los cocineros estrellas?\"                 \n[11] \"PNV y PSE impiden debatir una moción de urgencia sobre la tala de árboles en Gros\"              \n[12] \"Más de 96.000 personas están en riesgo de pobreza en Nafarroa, casi una de cada seis\"           \n[13] \"Denuncian un «trato indigno» hacia personas sin hogar en las Urgencias Sociales de Bilbo\"       \n[14] \"Lanik gabe dauden gazteen %72k 2024an lana aurkituko duela uste du\"                             \n[15] \"Fallece una persona en un choque frontal cerca del alto de Gaintxurizketa\"                      \n[16] \"Aniztasuna\"                                                                                     \n[17] \"La fiscal mantiene la petición de casi quince años para los acusados por la paliza de Zornotza\" \n[18] \"«Instituzioen logika XX. mendekoa da: bidea egin baino gehiago, bidea urratu egin behar da»\"    \n[19] \"Astigarraga eta Hernanik bisitariei zuzendutako mezua: «Ez da sagardoa, zu zara. Hartu ardura!»\"\n[20] \"Gorrotxategi se postula a las primarias en Podemos sin acuerdo aún con el resto de fuerzas\"     \n[21] \"Esparza dice que la adjudicación de Belate «apesta» y el Gobierno defiende su legalidad\"        \n[22] \"La FNSEA reclama una moratoria en la prohibición de usar pesticidas\"                            \n[23] \"Los bomberos de Donostia acuden al Pleno para denunciar que no han mejorado sus condiciones\"    \n[24] \"LAB denuncia la escasez de uniformes, sábanas y mantas en el hospital de Basurto\"               \n[25] \"Sindicatos se concentran en Gasteiz para pedir que se cumplan las medidas de salud laboral\"     \n[26] \"Gazako biztanleriaren erdia baino gehiago Rafahn pilatuta dago, NBEren arabera\"                 \n[27] \"Gaza: encendamos la luz de la solidaridad\"                                                      \n[28] \"Migrazio legearen alde bozkatu zuten hautetsien argazkiekin afitxak jarri ditu Bizi!k\"          \n[29] \"El juez no descarta el «ánimo homicida» en la causa de Tsunami para evitar la Ley de Amnistía\"  \n[30] \"Las milicias iraquíes proiraníes instan a extender sus ataques al Mediterráneo\"                 \n[31] \"El BCE mantiene los tipos de interés en el 4,5% por tercera vez consecutiva\"                    \n[32] \"Las lentejas, el tocino y la velocidad\"                                                         \n[33] \"Un niño sordo escucha por primera vez tras un innovador tratamiento génico en EEUU\"             \n[34] \"Elurra bezain zuria: ezohiko pinguino bat Antartikan\"                                           \n[35] \"Los hermanos Williams llegan a tiempo y desatan la locura en San Mamés (4-2)\"                   \n[36] \"La AN propone juzgar a Luis Rubiales por el beso «no consentido» a Jenni Hermoso\"               \n[37] \"La Real confirma la cesión del lateral Javi Galán, procedente del Atlético\"                     \n[38] \"Nicolás Alustiza, ilusionado tras sus primeros días como ciclista profesional con el Euskaltel\" \n[39] \"‘Euskararen baloia’ ekimenaren edizio berriari hasiera eman dio Eibarrek\"                       \n[40] \"Kilian Jornetek eta Zach Millerrek eliteko korrikalariei eskatu diete UTMB-i boikota egitea\"    \n[41] \"Jordan Theodore, tardío regalo navideño que viene para que Baskonia sea mejor equipo\"           \n[42] \"Bilbao Basket ya sabe lo que es perder en Europa y lía un tanto su pase a cuartos (82-80)\"      \n[43] \"«Lokalean bertsioekin jolasean hasi eta disko bat osatzeko erronka bete dugu»\"                  \n[44] \"dFeria cumple 30 años con Italia como país invitado, bajo el lema ‘Utopía’\"                     \n[45] \"Musika Bulegoa: «2023a urte ona izan da zuzeneko musikarentzat»\"                                \n[46] \"‘Ama’ diskoa aurkeztu du Tenpora taldeak, sei abesti berriz osatutako lana\"                     \n[47] \"Isabel Azkaratek artearekin eta sortzaileekin duen harremanaren lekuko da San Telmo\"            \n[48] \"Atzar Hadi! ikuskizuna Oialume Biltokian\"                                                       \n[49] \"Jon Gurrutxaga Marruma Kulturaletan\"                                                            \n[50] \"Letagin eta Nevadah indarrak batuz Ondarrun\"                                                    \n[51] \"Lausoka Txantreako Akelarre elkartean\"                                                          \n[52] \"Musikagaz Fest! jaialdiaren bigarren edizioa egingo dute Zornotzan\"                             \n[53] \"«Erresilientzia ez da presioa jasatea soilik, baizik eta esperientzietatik indartuta ateratzea»\"\n[54] \"Getariatik mundura: Cristobal Balenciaga\"                                                       \n[55] \"«Beldur naiz, akordio zabalen alde, abertzaletasuna alboratzen ari ez ote garen»\"               \n[56] \"Kaiman uharteak; finantzak, hondartzak eta askoz gehiago\"                                       \n[57] \"Zetaren Bideko hirietan zehar\"                                                                  \n[58] \"Urederra, harribitxi urdin turkesa, Urbasa mendilerroan\"                                        \n[59] \"«Lokalean bertsioekin jolasean hasi eta disko bat osatzeko erronka bete dugu»\"                  \n```\n:::\n:::\n\n\nNow we have vector with all the titles of the newspaper of the specific day.\n\n## 5 - Activities\n\nIf you are still\n\n-   Try to extract all the links for each title (Tip, use htlm_attr instead and html_text(\"href\"))\n\n-   Try to extract the author of each new, and figure out what is the problem with the lenght of the vector\n\n-   Try to extract the lenguage of each new (What news are in basque and wich ones are in spanish? Do it thinking to do it automaticlly)\n\n-   Try to save all the data in a data frame, each information of the new for each title\n\nThanks for see the article, and share it if you like it.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}